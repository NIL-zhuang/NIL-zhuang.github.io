<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>项目开发守则 - 抓鱼 zzy's Blog</title><meta name=Description content="ZZY的博客"><meta property="og:title" content="项目开发守则"><meta property="og:description" content="本项目是南京大学软件学院2018级软件工程与计算III课程设计项目 1. 总体规约 开发工具：Intellij IDEA 数据库管理工具：Navicat 项目文"><meta property="og:type" content="article"><meta property="og:url" content="https://nil-zhuang.github.io/2022/10/project_rule/"><meta property="og:image" content="https://nil-zhuang.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-28T15:06:28+08:00"><meta property="article:modified_time" content="2022-10-28T15:17:18+08:00"><meta property="og:site_name" content="抓鱼"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://nil-zhuang.github.io/logo.png"><meta name=twitter:title content="项目开发守则"><meta name=twitter:description content="本项目是南京大学软件学院2018级软件工程与计算III课程设计项目 1. 总体规约 开发工具：Intellij IDEA 数据库管理工具：Navicat 项目文"><meta name=application-name content="ZZY's Blog"><meta name=apple-mobile-web-app-title content="ZZY's Blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=icon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://nil-zhuang.github.io/2022/10/project_rule/><link rel=next href=https://nil-zhuang.github.io/2022/10/cpp_io/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"项目开发守则","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/nil-zhuang.github.io\/2022\/10\/project_rule\/"},"genre":"posts","wordcount":2755,"url":"https:\/\/nil-zhuang.github.io\/2022\/10\/project_rule\/","datePublished":"2022-10-28T15:06:28+08:00","dateModified":"2022-10-28T15:17:18+08:00","license":"Ziyuan Zhuang 2022","publisher":{"@type":"Organization","name":"Ziyuan Zhuang","logo":{"@type":"ImageObject","url":"https:\/\/nil-zhuang.github.io\/images\/avatar.jpeg","width":820,"height":820}},"author":{"@type":"Person","name":"Nil Zhuang"},"description":""}</script></head><body data-header-desktop=auto data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="抓鱼 zzy's Blog">🦊 Catch the Fish</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><a class=menu-item href=https://github.com/NIL-zhuang rel="noopener noreffer" target=_blank>🦊 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="抓鱼 zzy's Blog">🦊 Catch the Fish</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title>About</a><a class=menu-item href=https://github.com/NIL-zhuang title rel="noopener noreffer" target=_blank>🦊</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">项目开发守则</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://github.com/NIL-zhuang title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Nil Zhuang</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-10-28>2022-10-28</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;2755 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;6 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept=true><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#1-总体规约>1. 总体规约</a></li><li><a href=#2-编程规约>2. 编程规约</a><ul><li><a href=#21-代码规范>2.1 代码规范</a><ul><li><a href=#211-软工设计原则>2.1.1 软工设计原则</a></li></ul></li><li><a href=#22-注释规范>2.2 注释规范</a><ul><li><a href=#221-必须要写注释的情况>2.2.1 必须要写注释的情况</a></li></ul></li></ul></li><li><a href=#3-日志规约>3. 日志规约</a></li><li><a href=#4-测试规约>4. 测试规约</a></li><li><a href=#5-安全规约>5. 安全规约</a></li><li><a href=#6-数据库规约>6. 数据库规约</a><ul><li><a href=#61-建表规约>6.1 建表规约</a></li><li><a href=#62-sql规范>6.2 SQL规范</a></li></ul></li><li><a href=#7-版本控制规约>7. 版本控制规约</a><ul><li><a href=#71-commit规则>7.1 commit规则</a></li><li><a href=#72-开发规则>7.2 开发规则</a></li><li><a href=#73-其余规范>7.3 其余规范</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>本项目是南京大学软件学院2018级软件工程与计算III课程设计项目</p><h2 id=1-总体规约>1. 总体规约</h2><ol><li>开发工具：Intellij IDEA</li><li>数据库管理工具：Navicat</li><li>项目文档和沟通管理：飞书</li><li>项目版本管理工具：git</li><li>接口管理工具：Apifox</li></ol><h2 id=2-编程规约>2. 编程规约</h2><blockquote><p>Craftsmanship and the Problem of Productivity: Secrets for Going Fast without Making a Mess</p></blockquote><h3 id=21-代码规范>2.1 代码规范</h3><p>JAVA代码规范参照IDEA插件 <strong>Alibaba Java Coding Guidelines</strong>，尽量减少warning，不能存在error</p><h4 id=211-软工设计原则>2.1.1 软工设计原则</h4><ol><li><p>单一职责原则</p><p>对类来说，一个类应该只负责一项职责。如果一个类负责两个职责，可能存在职责1变化，引起职责2的变化情况。可以基于抽象逻辑，或者业务逻辑对类进行细化。</p></li><li><p>接口隔离原则</p><p>客户端不应该依赖它不需要的接口，一个类对另外一个类的依赖，应该建立在最小的接口上。</p></li><li><p>依赖倒置原则</p><p>高层模块不应该依赖低层模块，两者应依赖其抽象；抽象不应该依赖细节，细节应该依赖抽象；中心思想是面向接口编程。</p></li><li><p>里氏替换原则</p><p>如果将所有类型为T1的对象O1都替换成类型T2de对象O2，程序的行为不发生改变。那么类型T2是类型T1的子类型。换句话说说有引用基类的地方必须能透明的使用其子类的对象。</p></li><li><p>开闭原则</p><p>在代码结构的设计设计时，应该考虑对扩展开放，对修改关闭，抽象思维搭建结构，具体实现扩展细节。</p></li><li><p>迪米特法则</p><p>一个类对自己依赖的类知道的越要越好。也就是说，对于依赖的类不管多么复杂，都尽量将逻辑封装在类的内部。对外除了提供的public方法，不对外开放任何信息</p></li></ol><h3 id=22-注释规范>2.2 注释规范</h3><ol><li><strong>代码是用来读的</strong>，代码的意图应该由代码自身阐述，优先考虑写更可读的代码</li><li>代码意图明显的情况下，不要加注释重复说明</li><li>临时注释标记：TODO, FIXME, OPTIMIZE, REVIEW</li><li>注释应该随着代码更新</li></ol><h4 id=221-必须要写注释的情况>2.2.1 必须要写注释的情况</h4><p>为什么，而非是什么</p><ol><li>纲要性的注释：简洁清晰的描述一个文件、类或一个流程</li><li>复杂的业务逻辑、算法</li><li>代码的作用不直观时，解释这样做的原因</li><li>存在多种可选方案时，解释这样选择的原因</li><li>因为某些限制导致代码不一致、不优雅、存在副作用时，注明原因及后果</li><li>参考了外部资料时，要注明链接方便查看</li><li>所有的抽象方法</li></ol><h2 id=3-日志规约>3. 日志规约</h2><p>使用slf4j框架记录项目运行日志，不要用系统原生log</p><h2 id=4-测试规约>4. 测试规约</h2><p>AIR原则：单元测试在运行时，要感觉像AIR一样并不存在&ndash;Automatic, Independent, Repeatable</p><h2 id=5-安全规约>5. 安全规约</h2><ol><li>用户请求传入的任何参数必须做有效性验证，忽略参数校验可能导致<ol><li>page size过大导致内存溢出</li><li>恶意order导致数据库安全风险或慢查询</li></ol></li><li>用户敏感数据必须要放在数据库中，账号密码等强安全数据需要使用彩虹表等进行加密处理</li><li>用户传入的SQL参数严格使用参数绑定或metadata字段限定，防止SQL注入，禁止字符串拼接SQL访问数据库(还记得华为的drop databse吗)</li><li>隶属于用户个人的页面或者功能必须进行权限控制校验</li><li>在使用平台资源(短信、邮件、电话等)必须实现防重复限制，如数量限制、疲劳度控制、验证码校验等，避免被滥用</li></ol><h2 id=6-数据库规约>6. 数据库规约</h2><h3 id=61-建表规约>6.1 建表规约</h3><ol><li>表达是否概念的字段必须使用is_xxx方式命名，数据类型是<code>unsigned tinyint</code>(1表示是，0表示否)</li><li>如果用字符串来表示有限个状态(例如status)，必须在后端使用枚举类型传入参数</li><li>表名、字段名必须使用小写字母或数字，禁止数字开头，禁止两个下划线间只有数字。数据库字段名的修改代价很大，字段名的命名需要慎重考虑。<ul><li>Mysql在Windows下不区分大小写，而Linux下默认区分，因此不允许出现任何大写字母</li></ul></li><li>表名不使用复数名词<ul><li>表名应该仅仅表示表里面的实体内容，不应该表示实体数量，对应于DO类名也是单数形式，符合表达习惯</li></ul></li><li>小数类型为decimal，禁止使用float和double<ul><li>float和double在存储的时候，存在精度损失的问题，很可能在值的比较时，得到不正确的结果。如果存储的数据范围超过decimal的范围，建议将数据拆成整数和小数分开存储</li></ul></li><li>如果存储的字符串长度几乎相等，使用char定长字符串类型</li><li>varchar是可变长字符串，不预先分配存储空间，长度不要超过5000，如果存储长度大于此值，定义字段类型为text，独立出来一张表，用主键来对应，避免影响其它字段索引效率</li><li>表必备三字段：id, gmt_create, gmt_modified。<ul><li>其中id必为主键，类型为unsigned bigint、单表时自增、步长为 1。gmt_create, gmt_modified的类型均为timestamp类型，前者现在时表示主动创建，后者过去分词表示被动更新</li></ul></li><li>表的命名最好以<code>业务名称_表的作用</code>作为开头</li><li>字段允许适当冗余，以提高查询性能，但必须考虑数据一致。冗余字段应遵循<ol><li>不是频繁修改的字段。</li><li>不是varchar超长字段，更不能是text字段。</li></ol></li><li>所有字符的存储与表示都要以<code>utf-8</code>编码<ul><li>字符统计函数在不同编码有区别，因此统一编码</li></ul></li></ol><h3 id=62-sql规范>6.2 SQL规范</h3><ol><li>不要使用<code>count(列名)</code>或<code>count(常量)</code>来替代<code>count(*)</code>，<code>count</code>是统计行数的语法，和数据库无关，和NULL非NULL无关<ul><li><code>count(*)</code>会统计值为NULL的行，而<code>count(列名)</code>不会统计为NULL的行</li></ul></li><li>使用<code>ISNULL()</code>来判断是否为NULL，因为<code>NULL&lt;>NULL, NULL=NULL, NULL&lt;>1</code>的结果都是NULL而不是true</li></ol><h2 id=7-版本控制规约>7. 版本控制规约</h2><p>乱动origin/main者，狗头打掉！</p><blockquote><p><a href=https://ourai.ws/posts/working-with-git-in-team/ target=_blank rel="noopener noreffer">git团队实践</a>
<a href=http://www.ruanyifeng.com/blog/2015/08/git-use-process.html target=_blank rel="noopener noreffer">阮一峰git规范</a></p></blockquote><h3 id=71-commit规则>7.1 commit规则</h3><ol><li>commit记录以commit类型作为开头：<ol><li>feat 新特性</li><li>fix bug修复</li><li>hotfix 对生产代码的紧急修复</li><li>docs 文档改动</li><li>style 格式化</li><li>refactor 重构代码</li><li>test 项目测试</li></ol></li><li>commit的粒度是一个小功能点或一个bugfix，将恢复的误伤操作降到最低</li><li>commit记录中，用一句简练的话概括，然后空一行阐述提交增加或修改的地方</li><li>commit要有独立性，如果是多个功能相同或相近的commit可以使用rebase -i合并或调整；如果是对上一个commit的修正可以用amend修复；<strong>禁止无意义的commit</strong></li><li>如果有临时但暂时不需要提交的改动，可以用stash暂存代码</li><li>在有多个commit，功能开发到达一个里程碑节点或是完成功能再push，以整洁origin/master，尽可能一个push就是一个feat</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>    feat: 完成用户注册接口
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    UserController 添加了用户注册接口 /user/register
</span></span><span class=line><span class=cl>    UserService 用户注册接口 userRegister(UserVO)，用户密码提供了彩虹表校验
</span></span><span class=line><span class=cl>    UserMapper  userRegister(UserPO)
</span></span></code></pre></td></tr></table></div></div><h3 id=72-开发规则>7.2 开发规则</h3><p>我们需要一个干净整洁的work tree</p><ol><li>所有的项目开发都会在dev分支上进行，生产代码会保留在master分支上，非hotfix等紧急情况禁止向master分支提交</li><li>所有新feature的开发都需要建立一个新的、以该feature命名的分支，然后在该分支上进行提交后，将其<code>merge</code>到dev分支上</li><li>项目更新一律使用rebase，即<code>git pull --rebase</code></li></ol><h3 id=73-其余规范>7.3 其余规范</h3><ol><li>谁提交了.idea或者.vscode文件夹，谁请喝奶茶</li></ol></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-10-28</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2022/10/cpp_io/ class=next rel=next title=Cpp读写记录>Cpp读写记录<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.105.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2020 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://github.com/NIL-zhuang target=_blank>Nil Zhuang</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:50}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>